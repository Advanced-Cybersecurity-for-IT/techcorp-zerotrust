# ============================================================================
# SNORT CONFIGURATION
# TechCorp Zero Trust Architecture - Intrusion Detection System
# ============================================================================
# Minimal configuration for API-based packet analysis
# ============================================================================

# ----------------------------------------------------------------------------
# NETWORK VARIABLES
# ----------------------------------------------------------------------------
# Define the networks we're protecting
ipvar HOME_NET [172.28.2.0/24,172.28.3.0/24,172.28.4.0/24,172.28.5.0/24]
ipvar EXTERNAL_NET !$HOME_NET

# Define specific servers
ipvar DNS_SERVERS $HOME_NET
ipvar SMTP_SERVERS $HOME_NET
ipvar HTTP_SERVERS $HOME_NET
ipvar SQL_SERVERS $HOME_NET
ipvar TELNET_SERVERS $HOME_NET
ipvar SSH_SERVERS $HOME_NET
ipvar FTP_SERVERS $HOME_NET
ipvar SIP_SERVERS $HOME_NET

# Port variables
portvar HTTP_PORTS [80,8080,8180]
portvar SHELLCODE_PORTS !80
portvar ORACLE_PORTS 1024:
portvar SSH_PORTS 22
portvar FTP_PORTS [21,2100,3535]
portvar SIP_PORTS [5060,5061,5600]
portvar FILE_DATA_PORTS [$HTTP_PORTS,110,143]
portvar GTP_PORTS [2123,2152,3386]

# ----------------------------------------------------------------------------
# DECODER AND PREPROCESSOR CONFIGURATION
# ----------------------------------------------------------------------------
# Configure the packet decoder
config disable_decode_alerts
config disable_tcpopt_experimental_alerts
config disable_tcpopt_obsolete_alerts
config disable_tcpopt_ttcp_alerts
config disable_tcpopt_alerts
config disable_ipopt_alerts

# Configure checksum verification
config checksum_mode: none

# ----------------------------------------------------------------------------
# OUTPUT CONFIGURATION
# ----------------------------------------------------------------------------
# Output alerts to console in fast format (for parsing)
output alert_fast: stdout

# Also log to file
output alert_fast: /var/log/snort/alert

# ----------------------------------------------------------------------------
# RULE CONFIGURATION
# ----------------------------------------------------------------------------
# Path to rules
var RULE_PATH /etc/snort/rules

# Include classification config for classtypes
include /etc/snort/classification.config

# Include local rules (our custom detection rules)
include $RULE_PATH/local.rules

# ----------------------------------------------------------------------------
# DETECTION ENGINE
# ----------------------------------------------------------------------------
# Configure detection engine
config detection: search-method ac-bnfa

# ----------------------------------------------------------------------------
# EVENT FILTERING
# ----------------------------------------------------------------------------
# Limit alert rate to prevent flooding
config event_queue: max_queue 8 log 5 order_events content_length
