# ============================================================================
# CONFIGURAZIONE SNORT
# TechCorp Zero Trust Architecture - Intrusion Detection System
# ============================================================================
# Configurazione per pacchetti basata su API
# ============================================================================

# ----------------------------------------------------------------------------
# VARIABILI DI RETE
# ----------------------------------------------------------------------------
# Definizione reti
ipvar HOME_NET [172.28.2.0/24,172.28.3.0/24,172.28.4.0/24,172.28.5.0/24]
ipvar EXTERNAL_NET !$HOME_NET

# Definizione server
ipvar DNS_SERVERS $HOME_NET
ipvar SMTP_SERVERS $HOME_NET
ipvar HTTP_SERVERS $HOME_NET
ipvar SQL_SERVERS $HOME_NET
ipvar TELNET_SERVERS $HOME_NET
ipvar SSH_SERVERS $HOME_NET
ipvar FTP_SERVERS $HOME_NET
ipvar SIP_SERVERS $HOME_NET

# Porte
portvar HTTP_PORTS [80,8080,8180]
portvar SHELLCODE_PORTS !80
portvar ORACLE_PORTS 1024:
portvar SSH_PORTS 22
portvar FTP_PORTS [21,2100,3535]
portvar SIP_PORTS [5060,5061,5600]
portvar FILE_DATA_PORTS [$HTTP_PORTS,110,143]
portvar GTP_PORTS [2123,2152,3386]

# ----------------------------------------------------------------------------
# CONFIGURAZIONE DECODER E PREPROCESSOR
# ----------------------------------------------------------------------------
config disable_decode_alerts
config disable_tcpopt_experimental_alerts
config disable_tcpopt_obsolete_alerts
config disable_tcpopt_ttcp_alerts
config disable_tcpopt_alerts
config disable_ipopt_alerts

# Configura verifica checksum
config checksum_mode: none

# ----------------------------------------------------------------------------
# CONFIGURAZIONE OUTPUT
# ----------------------------------------------------------------------------
output alert_fast: stdout

# Log su file
output alert_fast: /var/log/snort/alert

# ----------------------------------------------------------------------------
# CONFIGURAZIONE REGOLE
# ----------------------------------------------------------------------------
# Percorso regole
var RULE_PATH /etc/snort/rules

# Include config classificazione
include /etc/snort/classification.config

# Include regole locali
include $RULE_PATH/local.rules

# ----------------------------------------------------------------------------
# METODO DI RILEVAMENTO
# ----------------------------------------------------------------------------
config detection: search-method ac-bnfa

# ----------------------------------------------------------------------------
# FILTRO EVENTI
# ----------------------------------------------------------------------------
config event_queue: max_queue 8 log 5 order_events content_length
